- content_for :title do @server.title end
.page-header
  - if can_manage(@server)
    .pull-right
      .btn-group 
        %button.btn.btn-primary.dropdown-toggle{"data-toggle" => 'dropdown'}
          Manage
          %span.caret
        %ul.dropdown-menu{role: "menu", id: "left-dropdown"}
          %li= link_to 'Edit', edit_server_path(@server)
          %li= link_to 'Delete', server_path(@server), method: :delete, data: {confirm: 'Are you sure you want to delete this server?'}
          %li= link_to 'Reports', server_reports_path(@server)
          %li
            %a{:href => "#contact", "data-toggle" => 'modal'} Sponsor
  %h1= @server.title
.container
  .row
    .col-md-12
      .div.text-center
        .btn-group
          - if current_user and current_user.has_favored(@server)
            = link_to '<i class="fa fa-heart"></i> Unfavor'.html_safe, server_favorite_path(@server, current_user.favorite_for(@server)), class: 'btn btn-danger', rel: "tooltip", title: "Remove this server from your favorites", method: :delete
          - else
            = link_to '<i class="fa fa-heart"></i> Favorite'.html_safe, new_server_favorite_path(@server), class: 'btn btn-danger', rel: "tooltip", title: "Add this server to your favorites"
          %a.btn.btn-success{href: server_vote_path(@server), rel: "tooltip", title: "Vote for this server."}
            %i.fa.fa-thumbs-up
            Vote
          %button.btn.btn-primary{"data-target" => "#connect-modal", "data-toggle" => "modal", rel: "tooltip", title: "Learn how to connect to this server."} 
            %i.fa.fa-play
            Connect
          #connect-modal.modal.fade{:role => "dialog", :tabindex => "-1"}
            .modal-dialog
              .modal-content
                .modal-header
                  %button.close{"data-dismiss" => "modal", :type => "button"}
                    %span{"aria-hidden" => "true"} Ã—
                    %span.sr-only Close
                  %h4.modal-title{style: 'text-align: left;'} Connecting
                .modal-body{style: 'text-align: left;'}
                  To connect to an Unturned Server follow these steps:
                  %ol
                    %li 
                      Open 
                      %a{href: "steam://rungameid/304930"} Unturned 
                      and select Play.
                    %li Click 'Connect.'
                    %li 
                      Set the port to 
                      %strong '#{@server.port}'
                    %li 
                      Set the IP Address to 
                      %strong '#{@server.ip}'
                    %li Click 'Connect.'
                .modal-footer
                  %button.btn.btn-danger{"data-dismiss" => "modal", :type => "button"} Close
          %a.btn.btn-danger{href: new_server_report_path(@server), rel: "tooltip", title: "Report an issue with this server."}
            %i.fa.fa-flag
            Report
  .row
    .col-md-12
      .text-center{style: "margin-top: 5px"}
        - if @server.steam != nil and @server.steam != ""
          %a.social{href: "http://steamcommunity.com/groups/#{@server.steam}", rel: "tooltip", title: "Server Steam Group", data: {placement: "top"}}
            %i.fa.fa-steam-square.social-media{style: "color: black;"}
        - if @server.facebook != nil  and @server.facebook != ""
          %a.social{href: "#{@server.facebook}", rel: "tooltip", title: "Server Facebook Page", data: {placement: "top"}}
            %i.fa.fa-facebook-square.social-media{style: "color: blue;"}
        - if @server.twitter != nil and @server.twitter != ""
          %a.social{href: "http://twitter.com/#{@server.twitter}", rel: "tooltip", title: "Server Twitter", data: {placement: "top"}}
            %i.fa.fa-twitter-square.social-media{style: "color: #4099FF;"}
        - if @server.reddit != nil and @server.reddit != ""
          %a.social{href: "http://reddit.com/r/#{@server.reddit}", rel: "tooltip", title: "Server Subreddit", data: {placement: "top"}}
            %i.fa.fa-reddit-square.social-media{style: "color: lightblue;"}
        - if @server.youtube != nil and @server.youtube != ""
          %a.social{href: "https://www.youtube.com/user/#{@server.youtube}", rel: "tooltip", title: "Youtube Channel", data: {placement: "top"}}
            %i.fa.fa-youtube-square.social-media{style: "color: #FF0202;"}
        - if @server.website != nil and @server.website != ""
          %a.social{href: @server.website, rel: "tooltip", title: "Server Website", data: {placement: "top"}}
            %i.fa.fa-html5.social-media
        :javascript
          $('.social').tooltip();
  .row
    .col-md-12
      .text-center
        %div{style: 'margin-top: 15px;'}
          = image_tag server_banner_url(@server), width: '468', height: '60'
  .row
    .col-md-6
      %h2 Server Information
      %hr
      %table.table.table-bordered
        %tbody
          %tr
            %td 
              .glyphicon.glyphicon-upload
              IP Address
            %td
              %span{id: 'server-ip', "data-clipboard-text" => @server.ip, rel: "tooltip", title: "Click to copy to clipboard.", href: "#", data: {placement: "top"}}= @server.ip
              :javascript
                var client = new ZeroClipboard(document.getElementById("server-ip"));
                $("#server-ip").tooltip();
          %tr
            %td
              .glyphicon.glyphicon-download 
              Port
            %td= @server.port
          %tr
            %td 
              %i.fa.fa-history
              Version
            %td.middle
              .label.label-primary= @server.version
          %tr
            %td 
              %i.fa.fa-list-ol
              Slots
            %td= @server.slots
          %tr
            %td
              %i.fa.fa-tag
              Tags
            %td
              .tags
                - @server.tags.each do |tag|
                  %li
                    %a{href: tag_path(tag)}= tag
          %tr
            %td 
              %i.fa.fa-user
              Owner
            %td= @server.user.username
          %tr
            %td
              %i.fa.fa-location-arrow
              Location
            %td= @server.location.gsub('-', ' ').titleize
          %tr
            %td 
              %i.fa.fa-calendar-o
              Registered
            %td.middle
              .label.label-default= time_ago_in_words(@server.created_at) + ' ago'
          %tr
            %td
              %i.fa.fa-calendar
              Updated
            %td.middle
              .label.label-default= time_ago_in_words(@server.updated_at) + ' ago'
    .col-md-6{id: "stats-col"}
      %h2 Statistics
      %hr
      %table.table.table-bordered
        %tbody
          %tr
            %td{style: 'width: 50%'}
              %i.fa.fa-heart
              Favorites
            %td= @server.favorites.size
          %tr  
            %td{style: 'width: 50%'}
              %i.fa.fa-thumbs-up
              Votes
            %td= @server.votes.size
          %tr
            %td{style: 'width: 50%'} 
              %i.fa.fa-eye
              Views
            %td 0
      .text-center
        %h3 Voting History
        %canvas{id: 'vote-chart', height: "350"}
        - today = Time.now
        :javascript
          var width = $("#stats-col").width();
          var canvas = document.getElementById("vote-chart");
          var ctx = canvas.getContext("2d");
          ctx.canvas.width = width;
          var data = {
              labels: ["#{(today - 6.day).strftime("%A")}", "#{(today - 5.day).strftime("%A")}", "#{(today - 4.day).strftime("%A")}", "#{(today - 3.day).strftime("%A")}", "#{(today - 2.day).strftime("%A")}", "#{(today - 1.day).strftime("%A")}", "#{today.strftime("%A")}"],
              datasets: [
                  {
                      label: "Vote Data",
                      fillColor: "rgba(151,187,205,0.2)",
                      strokeColor: "rgba(151,187,205,1)",
                      pointColor: "rgba(151,187,205,1)",
                      pointStrokeColor: "#fff",
                      pointHighlightFill: "#fff",
                      pointHighlightStroke: "rgba(151,187,205,1)",
                      data: [#{get_time(@server, 6)}, #{get_time(@server, 5)}, #{get_time(@server, 4)}, #{get_time(@server, 3)}, #{get_time(@server, 2)}, #{get_time(@server, 1)}, #{get_time(@server, 0)}]
                  }
              ]
          };
          var chart = new Chart(ctx).Line(data);
          chart.update();
  .row
    .col-md-6
      %h2 Social Media
      %hr
      .text-center
    .col-md-6
      %h2 
        Share
        %small 
          Promote Your Server
      %hr
      %span.st_facebook_large{:displaytext => "Facebook"}
      %span.st_googleplus_large{:displaytext => "Google +"}
      %span.st_twitter_large{:displaytext => "Tweet"}
      %span.st_email_large{:displaytext => "Email"}

  .row
    .col-md-12
      %h2 Description
      %hr
      = simple_format(@server.info)
  .row
    .col-md-12
      %h2 
        Comments
        .pull-right
          .btn.btn-primary{id: 'click-btn'} Add Comment
      %hr
      - if current_user
        %div{id: 'show-form', show: false}
          = render 'comments/form'
        :javascript
          $("#show-form").toggle("show"); 
          $("#click-btn").click(function() {
            if ($("#show-form").is(":visible")) {
              $("#click-btn").text("Add Comment")
            } else {
              $("#click-btn").text("Hide")
            } 
            $("#show-form").toggle("show"); 
          }); 
      - if @server.comments.select { | comment | comment.valid? }.any?
        = render 'comments/view'
      - else
        #none No comments have been posted yet.
:javascript
  var switchTo5x=true;
%script{:src => "http://w.sharethis.com/button/buttons.js", :type => "text/javascript"}
:javascript
  stLight.options({publisher: "c2e6e60e-c42d-4a9b-a6c5-0ca8e2f39a96", doNotHash: true, doNotCopy: true, hashAddressBar: false});